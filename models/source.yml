version: 2
sources:
  - name: cms_medicare
    description: "A replica of the bigquery dataset called cms_medicare."
    tables:
      - name: hospital_general_info
      - name: inpatient_charges_2012
      - name: inpatient_charges_2013
      - name: inpatient_charges_2014
      - name: physicians_and_other_supplier_2012
      - name: physicians_and_other_supplier_2013
      - name: physicians_and_other_supplier_2014

models:
    - name: 01_hospital_general_info
      description: "incremental materialization"
    - name: 02_inpatient_all
      description: "Union all inpatient_charges views"
    - name: 03_experience_cost
      description: "How costs are associated with patient experience"
    - name: 04_ownership_experience_cost
      description: "How costs are associated with patient experience by hospital ownership"
    - name: 05_state_experience_cost
      description: "How costs are associated with patient experience by state"
    - name: 06_physicians_2012
      description: "Clean physicians_and_other_supplier_2012"
    - name: 07_physicians_2013
      description: "Clean physicians_and_other_supplier_2013"
    - name: 08_physicians_2014
      description: "Clean physicians_and_other_supplier_2014"
    - name: 09_physicians_all
      description: "Union clean physicians_and_other_supplier"
    - name: 10_clean_physicians_all
      description: "Fix directions for all physicians_and_other_supplier"
    - name: 11_clean_hospital_general_info
      description: "Fix directions for hospital_general_info"
    - name: 12_physicians_hospital
      description: "Merge clean physicians_and_other_suppliers with clean hospital_general_info"
    - name: 13_aggregate
      description: "Group by hospital and provider type"
    - name: 14_services_ranked
      description: "WINDOW FUNCTION TO FIND RANK OF MEDICARE/MEDICAID SERVICES"
    - name: 15_top_providers_by_services
      description: "Departments with the most services"
    - name: 16_services_used_ranked
      description: "WINDOW FUNCTION TO FIND RANK OF MEDICARE/MEDICAID BENEFICIARIES"
    - name: 17_top_providers_by_services_used
      description: "Departments with the most services used by beneficiaries"
    - name: 18_avg_charges_ranked
      description: "WINDOW FUNCTION TO FIND RANK OF MEDICARE/MEDICAID CHARGES"
    - name: 19_top_providers_by_charges
      description: "Most expensive departments"
